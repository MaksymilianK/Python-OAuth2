(function(e){function t(t){for(var r,u,i=t[0],o=t[1],l=t[2],b=0,d=[];b<i.length;b++)u=i[b],Object.prototype.hasOwnProperty.call(c,u)&&c[u]&&d.push(c[u][0]),c[u]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);s&&s(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var o=n[i];0!==c[o]&&(r=!1)}r&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},c={app:0},a=[];function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/my-auth/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var s=o;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},2567:function(e,t,n){"use strict";n("9f88")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function c(e,t,n,c,a,u){var i=Object(r["x"])("TheHeader"),o=Object(r["x"])("router-view");return Object(r["q"])(),Object(r["e"])(r["a"],null,[Object(r["h"])(i),Object(r["f"])("main",null,[Object(r["h"])(o)])],64)}var a=function(e){return Object(r["t"])("data-v-6364ab84"),e=e(),Object(r["r"])(),e},u={class:"header"},i=a((function(){return Object(r["f"])("h1",null,"MyAuth",-1)})),o={key:0},l={class:"menu"},s={key:0},b=Object(r["g"])("Sign in"),d=Object(r["g"])("Sign up"),f={key:2},O=Object(r["g"])("Add client");function p(e,t,n,c,a,p){var j=Object(r["x"])("router-link");return Object(r["q"])(),Object(r["e"])("header",u,[i,c.current?(Object(r["q"])(),Object(r["e"])("p",o,Object(r["z"])(c.current),1)):Object(r["d"])("",!0),Object(r["f"])("ol",l,[c.current?(Object(r["q"])(),Object(r["e"])("li",s,[Object(r["f"])("button",{onClick:t[0]||(t[0]=function(){return c.signOut&&c.signOut.apply(c,arguments)})},"Sign out")])):(Object(r["q"])(),Object(r["e"])(r["a"],{key:1},[Object(r["f"])("li",null,[Object(r["h"])(j,{to:"sign-in"},{default:Object(r["D"])((function(){return[b]})),_:1})]),Object(r["f"])("li",null,[Object(r["h"])(j,{to:"sign-up"},{default:Object(r["D"])((function(){return[d]})),_:1})])],64)),c.current?(Object(r["q"])(),Object(r["e"])("li",f,[Object(r["h"])(j,{to:"add-client"},{default:Object(r["D"])((function(){return[O]})),_:1})])):Object(r["d"])("",!0)])])}var j=n("bee2"),v=n("d4ec"),h=(n("d3b7"),n("3ca3"),n("ddb0"),n("9861"),n("e9c4"),n("4ec9"),n("c1f9"),n("6062"),n("a630"),200),m=204,y=401,g=404,w=409,k={get:function(e,t){return _(e+"?"+new URLSearchParams(t),"GET",null)},post:function(e,t){return _(e,"POST",t)},put:function(e,t){return _(e,"PUT",t)},patch:function(e,t){return _(e,"PATCH",t)},delete:function(e,t){return _(e,"DELETE",t)}};function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return fetch("http://localhost:8080/my-auth/api"+e,{method:t,headers:{"Content-Type":"application/json; charset=UTF-8"},credentials:"include",body:n&&JSON.stringify(n,q)}).then(U)}function U(e){return console.log(e),e.status===m?new P(e.status,e.body):new Promise((function(t,n){return e.json().then((function(n){return t(new P(e.status,n))})).catch((function(e){return n(e)}))}))}function q(e,t){return t instanceof Map?Object.fromEntries(t.entries()):t instanceof Set?Array.from(t):null===t?void 0:t}var P=Object(j["a"])((function e(t,n){Object(v["a"])(this,e),this.status=t,this.body=n})),S=Object(j["a"])((function e(t,n){Object(v["a"])(this,e),this.email=t,this.password=n})),E=Object(j["a"])((function e(t,n,r){Object(v["a"])(this,e),this.nick=t,this.email=n,this.password=r})),T={_current:Object(r["v"])(""),get current(){return this._current},get_current:function(){var e=this;return k.get("/current-user").then((function(t){return e._try_set_current(t)}))},signUp:function(e){var t=this,n=new E(e.nick.value,e.email.value,e.password.value);return k.post("/users",n).then((function(e){return t._try_set_current(e)}))},signIn:function(e){var t=this,n=new S(e.email.value,e.password.value);return k.post("/current-user",n).then((function(e){return t._try_set_current(e)}))},signOut:function(){var e=this;return k.delete("/current-user").then((function(t){return e._try_unset_current(t)}))},_try_set_current:function(e){return e.status===h&&(this._current.value=e.body.nick),e},_try_unset_current:function(e){return e.status===m&&(this._current.value=""),e}},x=n("6c02"),z={name:"TheHeader",setup:function(){var e=Object(x["c"])();function t(){T.signOut().then((function(t){switch(t.status){case m:e.push({name:"home"});break;default:console.log("Unexpected status!",t.status);break}})).catch((function(e){console.log(e)}))}return{current:T.current,signOut:t}}},C=(n("ddd2"),n("6b0d")),R=n.n(C);const D=R()(z,[["render",p],["__scopeId","data-v-6364ab84"]]);var I=D,N={components:{TheHeader:I}};const A=R()(N,[["render",c]]);var B=A,V=function(e){return Object(r["t"])("data-v-ea82b990"),e=e(),Object(r["r"])(),e},H=V((function(){return Object(r["f"])("h2",null,"Home",-1)})),M={key:0,class:"login-status"},L={key:1,class:"login-status"};function J(e,t,n,c,a,u){return Object(r["q"])(),Object(r["e"])("article",null,[H,c.current?(Object(r["q"])(),Object(r["e"])("p",M," Status: zalogowany ")):(Object(r["q"])(),Object(r["e"])("p",L," Status: niezalogowany "))])}var $={name:"TheHome",setup:function(){return{current:T.current}}};n("8bcf");const F=R()($,[["render",J],["__scopeId","data-v-ea82b990"]]);var G=F,W=Object(r["f"])("h2",null,"Sign up",-1),K=Object(r["g"])(" Nick "),Q=Object(r["g"])(" Email "),X=Object(r["g"])(" Password "),Y=Object(r["g"])(" Repeat password "),Z=Object(r["f"])("button",{type:"submit"},"Sign up",-1),ee={key:0,class:"error"};function te(e,t,n,c,a,u){return Object(r["q"])(),Object(r["e"])("article",null,[W,Object(r["f"])("form",{onSubmit:t[4]||(t[4]=function(){return c.signUp&&c.signUp.apply(c,arguments)})},[Object(r["f"])("label",null,[K,Object(r["E"])(Object(r["f"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.nick=t})},null,512),[[r["B"],e.nick]])]),Object(r["f"])("label",null,[Q,Object(r["E"])(Object(r["f"])("input",{type:"email","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.email=t})},null,512),[[r["B"],e.email]])]),Object(r["f"])("label",null,[X,Object(r["E"])(Object(r["f"])("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.password=t})},null,512),[[r["B"],e.password]])]),Object(r["f"])("label",null,[Y,Object(r["E"])(Object(r["f"])("input",{type:"password","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.repeatPassword=t})},null,512),[[r["B"],e.repeatPassword]])]),Z],32),c.error?(Object(r["q"])(),Object(r["e"])("p",ee,Object(r["z"])(c.error),1)):Object(r["d"])("",!0)])}var ne=n("5530"),re=Object(j["a"])((function e(){Object(v["a"])(this,e),this.nick=Object(r["v"])(""),this.email=Object(r["v"])(""),this.password=Object(r["v"])(""),this.repeatPassword=Object(r["v"])("")})),ce=(n("ac1f"),n("00b4"),{validateNick:function(e){return ae.test(e)?"":"Nick's length must be between 3 and 16 and must consist only of letters, numbers and underscores!"},validateEmail:function(e){return ue.test(e)?"":"Email is invalid!"},validatePassword:function(e){return e.length<7||e.length>100?"Password's length must be between 7 and 100!":""},validatePasswordsMatch:function(e,t){return e!==t?"Password and repeated password differ!":""}}),ae=/^\w{3,16}$/,ue=/^\S+@\S+(\.\S+)+$/,ie=1,oe=2,le=3,se=4,be=6,de=7,fe={name:"TheSignUp",setup:function(){var e=Object(x["c"])();if(!T.current.value){var t=new re,n=Object(r["v"])(""),c=ce;return Object(ne["a"])(Object(ne["a"])({},t),{},{error:n,signUp:a})}function a(r){r.preventDefault(),n.value=c.validateNick(t.nick.value),n.value||(n.value=c.validateEmail(t.email.value),n.value||(n.value=c.validatePassword(t.password.value),n.value||(n.value=c.validatePasswordsMatch(t.password.value,t.repeatPassword.value),n.value||T.signUp(t).then((function(t){switch(t.status){case h:e.currentRoute.value.query["client_id"]?e.go(-1):e.push({name:"home"});break;case w:t.body.detail===oe?n.value="Email already exists!":t.body.detail===ie?n.value="Nick already exists!":n.value="Unexpected error!";break;default:n.value="Unexpected error!";break}})).catch((function(e){console.log(e),n.value="Connection error!"})))))}e.push({name:"home"})}};const Oe=R()(fe,[["render",te]]);var pe=Oe,je=Object(r["f"])("h2",null,"Sign in",-1),ve=Object(r["g"])(" Email "),he=Object(r["g"])(" Password "),me=Object(r["f"])("button",{type:"submit"},"Sign in",-1),ye={key:0,class:"error"};function ge(e,t,n,c,a,u){return Object(r["q"])(),Object(r["e"])("article",null,[je,Object(r["f"])("form",{onSubmit:t[2]||(t[2]=function(){return c.signIn&&c.signIn.apply(c,arguments)})},[Object(r["f"])("label",null,[ve,Object(r["E"])(Object(r["f"])("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.email=t})},null,512),[[r["B"],e.email]])]),Object(r["f"])("label",null,[he,Object(r["E"])(Object(r["f"])("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.password=t})},null,512),[[r["B"],e.password]])]),me],32),c.error?(Object(r["q"])(),Object(r["e"])("p",ye,Object(r["z"])(c.error),1)):Object(r["d"])("",!0)])}var we=Object(j["a"])((function e(){Object(v["a"])(this,e),this.email=Object(r["v"])(""),this.password=Object(r["v"])("")})),ke={name:"TheSignIn",setup:function(){var e=Object(x["c"])();if(!T.current.value){var t=new we,n=Object(r["v"])(""),c=ce;return Object(ne["a"])(Object(ne["a"])({},t),{},{error:n,signIn:a})}function a(r){r.preventDefault(),n.value=c.validateEmail(t.email.value),n.value||(n.value=c.validatePassword(t.password.value),n.value||T.signIn(t).then((function(t){switch(t.status){case h:e.currentRoute.value.query.client_id?e.go(-1):e.push({name:"home"});break;case y:t.body.detail===le?n.value="Email does not exist!":t.body.detail===se?n.value="Wrong password!":n.value="Unexpected error!";break;default:n.value="Unexpected error!";break}})).catch((function(e){console.log(e),n.value="Connection error!"})))}e.push({name:"home"})}};const _e=R()(ke,[["render",ge]]);var Ue=_e,qe=(n("b0c0"),n("a4d3"),n("e01a"),function(e){return Object(r["t"])("data-v-cffd6b28"),e=e(),Object(r["r"])(),e}),Pe=qe((function(){return Object(r["f"])("h2",null,"Add client",-1)})),Se=Object(r["g"])(" Name "),Ee=Object(r["g"])(" Description "),Te=Object(r["g"])(" Redirect URL "),xe=qe((function(){return Object(r["f"])("button",{type:"submit"},"Add client",-1)})),ze={key:0,class:"error"},Ce={key:1,class:"client-id"};function Re(e,t,n,c,a,u){return Object(r["q"])(),Object(r["e"])("article",null,[Pe,Object(r["f"])("form",{onSubmit:t[3]||(t[3]=function(){return c.addClient&&c.addClient.apply(c,arguments)})},[Object(r["f"])("label",null,[Se,Object(r["E"])(Object(r["f"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.name=t})},null,512),[[r["B"],e.name]])]),Object(r["f"])("label",null,[Ee,Object(r["E"])(Object(r["f"])("textarea",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.description=t})},null,512),[[r["B"],e.description]])]),Object(r["f"])("label",null,[Te,Object(r["E"])(Object(r["f"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.redirectUrl=t})},null,512),[[r["B"],e.redirectUrl]])]),xe],32),c.error?(Object(r["q"])(),Object(r["e"])("p",ze,Object(r["z"])(c.error),1)):Object(r["d"])("",!0),c.clientId?(Object(r["q"])(),Object(r["e"])("p",Ce,"Client ID: "+Object(r["z"])(c.clientId),1)):Object(r["d"])("",!0)])}var De=Object(j["a"])((function e(){Object(v["a"])(this,e),this.name=Object(r["v"])(""),this.description=Object(r["v"])(""),this.redirectUrl=Object(r["v"])("")})),Ie=Object(j["a"])((function e(t,n,r){Object(v["a"])(this,e),this.name=t,this.description=n,this.redirectUrl=r})),Ne={add:function(e){var t=new Ie(e.name.value,e.description.value,e.redirectUrl.value);return k.post("/clients",t)},get_client:function(e){return k.get("/clients/".concat(e))}},Ae={validateName:function(e){return Be.test(e)?"":"Name's length must be between 3 and 16 and must consist only of letters, numbers and underscores!"},validateDescription:function(e){return e.length<10||e.length>250?"Description's length must be between 10 and 250!":""},validateRedirectURL:function(e){return e?"":"Redirect URL must not be empty!"}},Be=/^\w{3,16}$/,Ve={name:"TheAddClient",setup:function(){var e=new De,t=Object(r["v"])(""),n=Object(r["v"])(null),c=Ae;function a(r){r.preventDefault(),t.value=c.validateName(e.name.value),t.value||(t.value=c.validateDescription(e.description.value),t.value||(t.value=c.validateRedirectURL(e.redirectUrl.value),t.value||Ne.add(e).then((function(e){switch(e.status){case h:t.value="",n.value=e.body.id;break;case y:t.value="Unauthorized! Sign in first!";break;case w:e.body.detail===be?t.value="Client name already exists!":e.body.detail===de?t.value="Client's redirect URL already exists!":t.value="Unexpected error!";break;default:t.value="Unexpected code",e.body.detail;break}})).catch((function(e){console.log(e),t.value="Connection error!"}))))}return Object(ne["a"])(Object(ne["a"])({},e),{},{error:t,clientId:n,addClient:a})}};n("2567");const He=R()(Ve,[["render",Re],["__scopeId","data-v-cffd6b28"]]);var Me=He,Le=Object(r["f"])("h2",null,"Authorize",-1),Je={key:0},$e=Object(r["f"])("h3",null,"Requested permissions",-1);function Fe(e,t,n,c,a,u){return Object(r["q"])(),Object(r["e"])("article",null,[Le,c.error?(Object(r["q"])(),Object(r["e"])("p",Je,Object(r["z"])(c.error),1)):Object(r["d"])("",!0),Object(r["f"])("section",null,[Object(r["f"])("h3",null,"Client "+Object(r["z"])(e.name),1),Object(r["f"])("p",null,Object(r["z"])(e.description),1)]),Object(r["f"])("section",null,[$e,Object(r["f"])("ul",null,[(Object(r["q"])(!0),Object(r["e"])(r["a"],null,Object(r["w"])(c.requestedScopes,(function(e){return Object(r["q"])(),Object(r["e"])("li",{key:e},Object(r["z"])(c.scopesDescriptions[e]),1)})),128))])]),c.error?Object(r["d"])("",!0):(Object(r["q"])(),Object(r["e"])("button",{key:1,onClick:t[0]||(t[0]=function(){return c.authorize&&c.authorize.apply(c,arguments)})},"Authorize"))])}n("1276");var Ge=function(){function e(){Object(v["a"])(this,e),this.id=Object(r["v"])(0),this.name=Object(r["v"])(""),this.description=Object(r["v"])(""),this.requestUrl=Object(r["v"])("")}return Object(j["a"])(e,[{key:"setResponse",value:function(e){this.id.value=e.id,this.name.value=e.name,this.description.value=e.description,this.requestUrl.value=e.requestUrl}}]),e}(),We={NOTE_READ:"Permission to read your notes",NOTE_CREATE:"Permission to create new notes",NOTE_EDIT:"Permission to modify or delete your notes"},Ke=(n("5319"),n("99af"),{authorize:function(e){return k.post("/authorization",e)},redirectToClient:function(e,t){window.location.replace("".concat(e,"?code=").concat(t))}}),Qe=Object(j["a"])((function e(t,n){Object(v["a"])(this,e),this.clientId=t,this.scope=n})),Xe={name:"TheAuthorization",setup:function(){var e=Object(x["c"])(),t=e.currentRoute.value.query;if(T.current.value){var n=new Ge,c=Object(r["v"])("");if(!t["client_id"])return c.value="Client id is empty!",{error:c};if(!t["scope"])return c.value="Scope list is empty!",{error:c};var a=t["scope"].split(",");return Ne.get_client(t["client_id"]).then((function(e){switch(e.status){case h:n.setResponse(e.body);break;case g:c.value="Client not found!";break;default:console.log(e.status),c.value="Unexpected HTTP status!";break}})).catch((function(e){console.log(e),c.value="Connection error!"})),Object(ne["a"])(Object(ne["a"])({},n),{},{requestedScopes:a,scopesDescriptions:We,error:c,authorize:u})}function u(){Ke.authorize(new Qe(n.id.value,a)).then((function(t){switch(t.status){case h:Ke.redirectToClient(t.body.redirectUrl,t.body.code);break;case g:c.value="Client not found!";break;case y:e.push({name:"sign-in"});break;default:console.log(t.status),c.value="Unexpected HTTP status!";break}}))}e.push({name:"sign-in",query:t})}};const Ye=R()(Xe,[["render",Fe]]);var Ze=Ye,et=[{path:"/",name:"home",component:G},{path:"/sign-up",name:"sign-up",component:pe},{path:"/sign-in",name:"sign-in",component:Ue},{path:"/add-client",name:"add-client",component:Me},{path:"/authorization",name:"auth",component:Ze}],tt=Object(x["a"])({history:Object(x["b"])("/my-auth/"),routes:et});T.get_current().then((function(){return Object(r["c"])(B).use(tt).mount("#app")}))},"8bcf":function(e,t,n){"use strict";n("9b0c")},"9b0c":function(e,t,n){},"9f88":function(e,t,n){},c322:function(e,t,n){},ddd2:function(e,t,n){"use strict";n("c322")}});
//# sourceMappingURL=app.e3d3f455.js.map